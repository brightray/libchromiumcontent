#!/usr/bin/env python

import glob
import os
import subprocess
import sys


SOURCE_ROOT = os.path.abspath(os.path.dirname(os.path.dirname(__file__)))
PATCHES_DIR = os.path.join(SOURCE_ROOT, 'patches')
VENDOR_DIR = os.path.join(SOURCE_ROOT, 'vendor')
SRC_DIR = os.path.join(VENDOR_DIR, 'chromium', 'src')
PATCH_PY = os.path.join(VENDOR_DIR, 'python-patch', 'patch.py')


def main():
    for patch in glob.glob(os.path.join(PATCHES_DIR, '*.patch')):
        subprocess.check_call([sys.executable, PATCH_PY,
                               '--directory', SRC_DIR,
                               '--quiet',
                               patch])


if __name__ == '__main__':
    sys.exit(main())
